# Integration Test Configuration
# This file contains configuration settings for SSTI integration testing

[general]
# Maximum time to wait for applications to start (seconds)
startup_timeout = 30

# Delay between starting applications (seconds)
startup_delay = 2

# Maximum time for individual test requests (seconds)
request_timeout = 5

# Delay between individual test requests (seconds)
request_delay = 0.1

# Number of retry attempts for failed requests
retry_attempts = 3

[ports]
# Port assignments for vulnerable applications
jinja2_flask = 5000
django_templates = 8000
twig_symfony = 8080
smarty = 8081
freemarker_spring = 8082
velocity_spring = 8083
thymeleaf_spring = 8084
handlebars_express = 3000
erb_rails = 3001

[logging]
# Log level (DEBUG, INFO, WARNING, ERROR)
log_level = INFO

# Log file path (relative to test directory)
log_file = test_results/integration_tests.log

# Enable console output
console_output = true

# Enable detailed request/response logging
detailed_logging = false

[reporting]
# Generate HTML report
generate_html = true

# Generate JSON report  
generate_json = true

# Generate CSV report
generate_csv = true

# Include response snippets in reports
include_responses = true

# Maximum response snippet length
max_response_length = 200

[security]
# Allowed hosts for testing (security measure)
allowed_hosts = ["localhost", "127.0.0.1"]

# Maximum payload length
max_payload_length = 1000

# Disable dangerous payloads in production
safe_mode = false

[engines]
# Template engine configurations

[engines.jinja2]
enabled = true
risk_level = high
test_categories = ["math", "config", "request", "introspection", "class_walk"]

[engines.django]
enabled = true  
risk_level = high
test_categories = ["filter_math", "settings", "debug", "request_meta"]

[engines.twig]
enabled = true
risk_level = high
test_categories = ["math", "dump", "self_reference", "context_access"]

[engines.smarty] 
enabled = true
risk_level = high
test_categories = ["math", "php_execution", "server_vars", "eval"]

[engines.freemarker]
enabled = true
risk_level = high
test_categories = ["math", "class_access", "execute", "runtime_access"]

[engines.velocity]
enabled = true
risk_level = high
test_categories = ["math", "class_access", "tool_access", "method_call"]

[engines.thymeleaf]
enabled = true
risk_level = medium
test_categories = ["expression", "utility", "context_access"]

[engines.handlebars]
enabled = true
risk_level = medium  
test_categories = ["constructor", "prototype", "helper_access"]

[engines.erb]
enabled = true
risk_level = high
test_categories = ["ruby_eval", "rails_access", "system_call"]
